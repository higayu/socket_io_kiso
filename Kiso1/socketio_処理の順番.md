# Node.js + Express + Socket.IO におけるコードの順番の重要性

以下は、サーバー構築時における正しいコードの順番とその意味です。

---

## ✅ 正しいコードの順番と役割

### ① `app.get(...)` - ルート設定

```js
app.get('/', (req, res) => {
  res.sendFile(__dirname + '/index.html');
});
```

- ブラウザがアクセスしたときの最初の入口を定義
- HTMLファイルなどを返す
- これがないとクライアントが初期表示できない

---

### ② `io.on('connection', ...)` - WebSocket の受信設定

```js
io.on('connection', (socket) => {
  console.log('ユーザーが接続しました');
});
```

- Socket.IO クライアントが `io()` を実行したタイミングで呼ばれる
- クライアントとの接続を受け取るイベントハンドラ
- サーバー起動前に設定しておく必要がある

---

### ③ `server.listen(...)` - サーバー起動

```js
server.listen(3000, () => {
  console.log('http://localhost:3000 でサーバー起動中');
});
```

- サーバーをポート3000で起動
- ここが呼ばれて初めて外部アクセスが可能になる
- 必ず全設定のあとに呼び出すこと

---

## 🔁 順番を間違えると？

| 誤った順番 | 問題点 |
|------------|--------|
| `server.listen()` を先に呼ぶ | サーバーが起動してもルートやソケットの設定が間に合わず、正常動作しない可能性あり |
| `io.on('connection')` を後ろに書く | 接続イベントを受け取れない（ハンドラが未設定） |
| `app.get()` を後ろに書く | `index.html` が返せず、Socket.IO クライアントも動かない |

---

## 🎯 結論

- コードの実行順はとても重要
- **設定 → 起動** の流れで書くのが基本

